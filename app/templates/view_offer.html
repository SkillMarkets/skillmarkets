{% extends "base.html" %}
{% block content %}
<div class="card">
    <h2>{{ offer.title }}</h2>
    <p><strong>–ü—Ä–µ–¥–º–µ—Ç:</strong> {{ offer.subject }}</p>
    <p><strong>–¶–µ–Ω–∞:</strong> ${{ offer.price_per_hour }} / —á–∞—Å</p>
    <p><strong>–†–µ–ø–µ—Ç–∏—Ç–æ—Ä:</strong> {{ offer.tutor.username }}</p>
    
    {% if offer.tutor.average_rating > 0 %}
        <p><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> ‚≠ê {{ offer.tutor.average_rating }} ({{ offer.tutor.reviews_received|length }} –æ—Ç–∑—ã–≤–æ–≤)</p>
    {% endif %}
    
    <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
    <p>{{ offer.description }}</p>
    
    {% if current_user.is_authenticated %}
        {% if not current_user.is_tutor and current_user.id != offer.tutor.id %}
            <div style="margin-top:20px; display:flex; gap:10px; flex-wrap:wrap;">
                <a href="{{ url_for('main.chat', user_id=offer.tutor.id) }}" class="btn">üí¨ –ù–∞–ø–∏—Å–∞—Ç—å</a>
                <a href="{{ url_for('main.book_tutor', offer_id=offer.id) }}" class="btn">üìÖ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</a>
            </div>
        {% elif current_user.id == offer.tutor.id %}
            <p><em>–≠—Ç–æ –≤–∞—à–∞ —É—Å–ª—É–≥–∞.</em></p>
        {% endif %}
    {% else %}
        <p><a href="{{ url_for('auth.login') }}" class="btn btn-outline">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã —Å–≤—è–∑–∞—Ç—å—Å—è —Å —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–æ–º –∏–ª–∏ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏–µ.</p>
    {% endif %}
</div>

<!-- –û—Ç–∑—ã–≤—ã –æ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–µ -->
{% if offer.tutor.reviews_received %}
    <div class="card">
        <h3>–û—Ç–∑—ã–≤—ã –æ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–µ</h3>
        {% for review in offer.tutor.reviews_received %}
        <div style="background:#f8f9fa; padding:12px; border-radius:6px; margin:10px 0;">
            <strong>{{ review.reviewer.username }}:</strong> ‚≠ê {{ review.rating }}/5<br>
            {{ review.comment or '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è' }}
            <br><small>{{ review.created_at.strftime('%d.%m.%Y') }}</small>
        </div>
        {% endfor %}
    </div>
{% endif %}

<a href="{{ url_for('main.index') }}" style="display:inline-block; margin-top:20px;">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–æ–≤</a>
{% endblock %}